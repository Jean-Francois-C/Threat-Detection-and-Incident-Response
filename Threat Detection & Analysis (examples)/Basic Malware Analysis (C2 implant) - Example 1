===================================================================================================================================
Basic malware analysis using various tools (CAPA malware analysis tool, VirusTotal & MetaDefender malware analysis platforms)
===================================================================================================================================

--------------------------------------------
Malware sample (Nim-Rev-Shell-Stageless.exe)
--------------------------------------------
> I used as a sample a reverse (stageless) meterpreter shell (PE) packed/obfuscated/encrypted with the tool "Nimcrypt2".
> Nimcrypt2 is PE packer/loader designed to bypass AV/EDR solutions (https://github.com/icyguider/Nimcrypt2). 

--------------------------------------------
Malware analysis tools
--------------------------------------------
> CAPA (malware analysis tool - https://github.com/mandiant/capa)
  It detects capabilities in executable files and can be run against a PE, ELF, .NET module, shellcode file. 
> VirusTotal (on-line malware analysis platform - https://www.virustotal.com)
  It aggregates 70+ antivirus products and online scan engines.
> MetaDefender Cloud (on-line malware analysis platform - https://metadefender.opswat.com)

--------------------------------------------
Malware analysis - Results
--------------------------------------------
> CAPA detected that the file is malicious and identified that it implements defense evasion techniques (obfuscation, encryption, vm-detection/sandbox evasion) 
  and code execution techniques (process/inject, load-code/pe).

> VirusTotal reported the file as malicious and provided many information about our malware (which is rightfully identified as a C2 implant written in Nim):
  + Report: https://www.virustotal.com/gui/file/0230ab17095485c3ccd7f09ce03b7c5da4d546591bcc1ed40b105a3822e560fa
  + Originally: 27/63 security vendors flagged the file as malicious
  + After 2 days: 
    => 43/71 security vendors flagged the file as malicious
    => 1 sandbox flagged the file as malicious
  + Popular threat label: trojan.cryptim/marte
  + Threat categories: trojan
  + Family labels: cryptim | marte | cobaltstrike
  + Examples of IoC: 
    => hashes (MD5:326a2e96597f028078cb9430290e0486, SHA-1:483cd7fa7564e1fc1ef74bc177d787a5f18c62fa, etc.)
    => IP address of my C2 server (https://192.168.1.30/jrHfVIB6ujjTu9K5sCQzrwXoA0s-awO5m714LQwLFa2cQKXGqmngZjhREbKuaIHEU2bZXHpM<SNIP>)
    => several YARA rules from the 'THOR APT' scanner were triggered/matched:
       > RULE: SUSP_Nim_Implant_Characteristics_Jan23_1
         Detects characteristics found in Nim based loaders
       > RULE: SUSP_ShellCode_Loader_Indicators_Nov22_1
         Detects indicators found in shellcode loaders
       > RULE: HKTL_Nim_Loader_Jul21_1
         Detects Nim based ShellCode loaders
       > RULE: SUSP_Double_Base64Encoded_Kernel32_Functions
         Detects suspicious double base64 encoded kernel32 functions like OpenProcess, WriteProcessMemory and CreateRemoteThread
       > ...
    => several SIGMA rules (crowdsourced) were triggered/matched:
       > It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns
         the process and injects code into the process memory space.
       > Detects an uncommon svchost parent process.

> MetaDefender reported also the file as malicious and provided some information about our malware:
  + Report: https://metadefender.opswat.com/results/file/bzI0MDIxMkZ2cDVQMEhnT2VRZGUtcll1WE4_mdaas/regular/multiscan
  + Threats detected: 3/11 ENGINES
  + Threat name: Unknown Threat

===================================================================================================================================
CAPA malware analysis tool - Detailed results
===================================================================================================================================

Microsoft Windows [Version 10.0.19045.3930]
(c) Microsoft Corporation. All rights reserved.

C:\Users\auditor\Documents\Tools\17-DFIR\capa-v7.0.1> capa.exe Nim-Rev-Shell-Stageless.exe

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¯â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‘
â”‚ md5                    â”‚ 326a2e96597f028078cb9430290e0486                                                        â”‚
â”‚ sha1                   â”‚ 483cd7fa7564e1fc1ef74bc177d787a5f18c62fa                                                â”‚
â”‚ sha256                 â”‚ 0230ab17095485c3ccd7f09ce03b7c5da4d546591bcc1ed40b105a3822e560fa                        â”‚
â”‚ analysis               â”‚ static                                                                                  â”‚
â”‚ os                     â”‚ windows                                                                                 â”‚
â”‚ format                 â”‚ pe                                                                                      â”‚
â”‚ arch                   â”‚ amd64                                                                                   â”‚
â”‚ path                   â”‚ C:/Users/auditor/Documents/Tools/17-DFIR/capa-v7.0.1/Nim-Rev-Shell-Stageless.exe        â”‚
â”•â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”·â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”™

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¯â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‘
â”‚ ATT&CK Tactic          â”‚ ATT&CK Technique                                                                   â”‚
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¿â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¥
â”‚ DEFENSE EVASION        â”‚ Obfuscated Files or Information T1027                                              â”‚
â”‚                        â”‚ Virtualization/Sandbox Evasion::System Checks T1497.001                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EXECUTION              â”‚ Shared Modules T1129                                                               â”‚
â”•â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”·â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”™

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¯â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‘
â”‚ MBC Objective               â”‚ MBC Behavior                                                                  â”‚
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¿â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¥
â”‚ ANTI-BEHAVIORAL ANALYSIS    â”‚ Virtual Machine Detection [B0009]                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DATA                        â”‚ Check String [C0019]                                                          â”‚
â”‚                             â”‚ Encode Data::Base64 [C0026.001]                                               â”‚
â”‚                             â”‚ Encode Data::XOR [C0026.002]                                                  â”‚
â”‚                             â”‚ Non-Cryptographic Hash::MurmurHash [C0030.001]                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DEFENSE EVASION             â”‚ Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DISCOVERY                   â”‚ Code Discovery::Enumerate PE Sections [B0046.001]                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FILE SYSTEM                 â”‚ Writes File [C0052]                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MEMORY                      â”‚ Allocate Memory [C0007]                                                       â”‚
â”•â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”·â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”™

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¯â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‘
â”‚ Capability                                           â”‚ Namespace                                            â”‚
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¿â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¥
â”‚ reference anti-VM strings targeting Xen              â”‚ anti-analysis/anti-vm/vm-detection                   â”‚
â”‚ compiled with Nim                                    â”‚ compiler/nim                                         â”‚
â”‚ encode data using Base64                             â”‚ data-manipulation/encoding/base64                    â”‚
â”‚ reference Base64 string                              â”‚ data-manipulation/encoding/base64                    â”‚
â”‚ encode data using XOR                                â”‚ data-manipulation/encoding/xor                       â”‚
â”‚ hash data using murmur3                              â”‚ data-manipulation/hashing/murmur                     â”‚
â”‚ contain a thread local storage (.tls) section        â”‚ executable/pe/section/tls                            â”‚
â”‚ write file on Windows (3 matches)                    â”‚ host-interaction/file-system/write                   â”‚
â”‚ get thread local storage value                       â”‚ host-interaction/process                             â”‚
â”‚ allocate or change RWX memory                        â”‚ host-interaction/process/inject                      â”‚
â”‚ link function at runtime on Windows (2 matches)      â”‚ linking/runtime-linking                              â”‚
â”‚ enumerate PE sections (4 matches)                    â”‚ load-code/pe                                         â”‚
â”‚ parse PE header (9 matches)                          â”‚ load-code/pe                                         â”‚
â”‚ resolve function by parsing PE exports               â”‚ load-code/pe                                         â”‚
â”•â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”·â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”™


C:\Users\auditor\Documents\Tools\17-DFIR\capa-v7.0.1>capa.exe Nim-Rev-Shell-Stageless.exe -v

md5                     326a2e96597f028078cb9430290e0486
sha1                    483cd7fa7564e1fc1ef74bc177d787a5f18c62fa
sha256                  0230ab17095485c3ccd7f09ce03b7c5da4d546591bcc1ed40b105a3822e560fa
path                    C:/Users/auditor/Documents/Tools/17-DFIR/capa-v7.0.1/Nim-Rev-Shell-Stageless.exe
timestamp               2024-02-13 02:08:26.628529
capa version            7.0.1
os                      windows
format                  pe
arch                    amd64
analysis                static
extractor               VivisectFeatureExtractor
base address            0x400000
rules                   C:/Users/auditor/AppData/Local/Temp/_MEI135122/rules
function count          476
library function count  1
total feature count     31381

reference anti-VM strings targeting Xen
namespace  anti-analysis/anti-vm/vm-detection
scope      file

compiled with Nim
namespace  compiler/nim
scope      file

encode data using Base64
namespace  data-manipulation/encoding/base64
scope      function
matches    0x40CA19

reference Base64 string
namespace  data-manipulation/encoding/base64
scope      file

encode data using XOR
namespace  data-manipulation/encoding/xor
scope      basic block
matches    0x407554

hash data using murmur3
namespace  data-manipulation/hashing/murmur
scope      function
matches    0x407320

contain a thread local storage (.tls) section
namespace  executable/pe/section/tls
scope      file

write file on Windows (3 matches)
namespace  host-interaction/file-system/write
scope      function
matches    0x401E58
           0x402014
           0x411DA0

get thread local storage value
namespace  host-interaction/process
scope      function
matches    0x412430

allocate or change RWX memory
namespace  host-interaction/process/inject
scope      basic block
matches    0x411EF0

link function at runtime on Windows (2 matches)
namespace  linking/runtime-linking
scope      function
matches    0x405399
           0x40A6DB

enumerate PE sections (4 matches)
namespace  load-code/pe
scope      function
matches    0x4126D0
           0x4127C0
           0x412930
           0x4129C0

parse PE header (9 matches)
namespace  load-code/pe
scope      function
matches    0x401010
           0x4126A0
           0x412720
           0x4127C0
           0x412840
           0x412880
           0x4128F0
           0x412930
           0x4129C0

resolve function by parsing PE exports
namespace  load-code/pe
scope      function
matches    0x40F7EE

===================================================================================================================================
VirusTotal malware analysis platform - Detailed results
===================================================================================================================================

> VirusTotal report
  + https://www.virustotal.com/gui/file-analysis/MzI2YTJlOTY1OTdmMDI4MDc4Y2I5NDMwMjkwZTA0ODY6MTcwNzc3NjgxMA==
  + https://www.virustotal.com/gui/file/0230ab17095485c3ccd7f09ce03b7c5da4d546591bcc1ed40b105a3822e560fa/details

  + Originally: 27/63 security vendors flagged the file as malicious
  + After 2 days: 
    => 43/71 security vendors flagged the file as malicious
    => 1 sandbox flagged the file as malicious
  + Popular threat label: trojan.cryptim/marte
  + Threat categories: trojan
  + Family labels: cryptim | marte | cobaltstrike
  + Examples of IoC: 
    => hashes (MD5:326a2e96597f028078cb9430290e0486, SHA-1:483cd7fa7564e1fc1ef74bc177d787a5f18c62fa, etc.)
    => IP address of my C2 server (https://192.168.1.30/jrHfVIB6ujjTu9K5sCQzrwXoA0s-awO5m714LQwLFa2cQKXGqmngZjhREbKuaIHEU2bZXHpM<SNIP>)
    => several YARA rules from the 'THOR APT' scanner were triggered/matched:
       > RULE: SUSP_Nim_Implant_Characteristics_Jan23_1
         Detects characteristics found in Nim based loaders
       > RULE: HKTL_Nim_Loader_Jul21_1
         Detects Nim based ShellCode loaders
       > RULE: SUSP_Double_Base64Encoded_Kernel32_Functions
         Detects suspicious double base64 encoded kernel32 functions like OpenProcess, WriteProcessMemory and CreateRemoteThread
       > ...
    => several SIGMA rules were triggered/matched:
       > It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns
         the process and injects code into the process memory space.
       > Detects an uncommon svchost parent process.

======================================
Detection - Security vendors' analysis
======================================
Acronis (Static ML) - Suspicious
AhnLab-V3 - Trojan/Win.Generic.C4388187
ALYac - Generic.Trojan.Cryptim.Marte.A.28A1F941
Arcabit - Generic.Trojan.Cryptim.Marte.A.28A1F941
BitDefender - Generic.Trojan.Cryptim.Marte.A.28A1F941
Bkav Pro - W64.AIDetectMalware
CrowdStrike Falcon - Win/malicious_confidence_90% (D)
Cybereason - Malicious.a7564e
Cynet - Malicious (score: 100)
DeepInstinct - MALICIOUS
Elastic - Malicious (high Confidence)
Emsisoft - Generic.Trojan.Cryptim.Marte.A.28A1F941 (B)
eScan - Generic.Trojan.Cryptim.Marte.A.28A1F941
ESET-NOD32 - A Variant Of Win64/CobaltStrike.Beacon.L.gen
GData - Generic.Trojan.Cryptim.Marte.A.28A1F941
Google - Detected
Ikarus - Virus.Win32.Meterpreter
Malwarebytes - Generic.Malware.AI.DDS
MAX - Malware (ai Score=84)
Microsoft - Trojan:Win64/KekeoLodr.MK!MTB
Sangfor Engine Zero - Trojan.Win32.Save.a
SecureAge - Malicious
SentinelOne (Static ML)	- Static AI - Suspicious PE
Skyhigh (SWG) - BehavesLike.Win64.Generic.fc
Sophos - ATK/NimCrypt-C
Symantec - ML.Attribute.HighConfidence
Trellix (FireEye) - Generic.mg.326a2e96597f0280
VIPRE - Generic.Trojan.Cryptim.Marte.A.28A1F941
<SNIP>
Kaspersky - Undetected
Kingsoft - Undetected
Lionic - Undetected
MaxSecure - Undetected
McAfee - Undetected
NANO-Antivirus - Undetected
Palo Alto Networks - Undetected
Panda - Undetected
<SNIP>


======================================
Details
======================================

Basic properties
----------------
> MD5		326a2e96597f028078cb9430290e0486 
> SHA-1		483cd7fa7564e1fc1ef74bc177d787a5f18c62fa 
> SHA-256	0230ab17095485c3ccd7f09ce03b7c5da4d546591bcc1ed40b105a3822e560fa 
> Vhash		0350a76d1575551c0d1d1az122dlz1fz 
> Authentihash	2b81e238f70d26739b7a5dcd81455787e83929846a40313fd6799d8d2c98aa1b 
> Imphash	fdb7e26f36d2ece1a6332048efc675b3 
> SSDEEP	6144:XUOotoKGVXgITXxoQKgrQuxMwhYi2APnMy7Sg5Lfyx52xKtGUGwkdP3MIgma:EOou5SITXx1OAPMi/Lfj8TGwIP8Ila 
> TLSH		T10684F117B28688BCC62FC6304DDB93739576F8525935B92F2929F7302E70E90435EE68 
> File type	Win32 EXE executable  windows  win32  pe  peexe
> Magic		PE32+ executable (GUI) x86-64 (stripped to external PDB), for MS Windows 
> TrID		Microsoft Visual C++ compiled executable (generic) (41.1%)   Win64 Executable (generic) (26.1%)   Win16 NE executable (generic) (12.5%)   Windows Icons Library (generic) (5.1%)   OS/2 Executable (generic) (5%) 
> DetectItEasy	PE64   Compiler: Nim   Linker: GNU linker ld (GNU Binutils) (2.35) [GUI64] 
> File size	383.50 KB (392704 bytes)

History
-------
> Creation Time		2022-12-30 23:52:57 UTC 
> First Submission	2024-02-12 22:26:50 UTC 
> Last Submission	2024-02-12 22:26:50 UTC 
> Last Analysis		2024-02-12 22:26:50 UTC

Names
-----
> Nim-Rev-Shell-Stageless.exe

Portable Executable Info
------------------------
Header
> Target Machine	x64 
> Compilation Timestamp	2022-12-30 23:52:57 UTC 
> Entry Point		5312 
> Contained Sections	10


======================================
Activity Summary
======================================

Dynamic Analysis Sandbox Detections
-----------------------------------
> The sandbox Zenbox flags this file as: MALWARE TROJAN EVADER 

MITRE ATT&CK Tactics and Techniques
----------------------------------
> Execution - TA0002
> Privilege Escalation - TA0004
> Defense Evasion - TA0005
> Discovery - TA0007
> Command and Control - TA0011

Capabilities
-------------
> data-manipulation
> host-interaction
> load-code
> linking
> executable
> anti-analysis
> compiler 
> ...

Crowdsourced Sigma Rules
------------------------
> Matches rule (High): Suspect Svchost Activity by David Burkett, @signalblur at Sigma Integrated Rule Set (GitHub).
                       => It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns
                          the process and injects code into the process memory space.

> Matches rule (Medium): Uncommon Svchost Parent Process by Florian Roth (Nextron Systems) at Sigma Integrated Rule Set (GitHub).
                         => Detects an uncommon svchost parent process.

> Matches rule (Low): Windows Processes Suspicious Parent Directory by vburov at Sigma Integrated Rule Set (GitHub).
                      => Detect suspicious parent processes of well-known Windows processes.

Memory Pattern Urls
-------------------
> https://192.168.1.30/jrHfVIB6ujjTu9K5sCQzrwXoA0s-awO5m714LQwLFa2cQKXGqmngZjhREbKuaIHEU2bZXHpM7AGKycY

Registry actions - Registry Keys Opened
---------------------------------------
> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\GRE_Initialize\DisableMetaFiles
> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting\WMR\Disable
> HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\GRE_Initialize
> HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\Windows Error Reporting\WMR
<SNIP> 

Process and service actions - Processes created
-----------------------------------------------
> %SAMPLEPATH%\Nim-Rev-Shell-Stageless.exe
> C:\Users\user\Desktop\Nim-Rev-Shell-Stageless.exe
> C:\Windows\System32\svchost.exe
> C:\Windows\System32\svchost.exe svchost.exe

Shell Commands
--------------
> "%SAMPLEPATH%\Nim-Rev-Shell-Stageless.exe"
> svchost.exe

Processes Terminated
--------------------
> %SAMPLEPATH%\Nim-Rev-Shell-Stageless.exe

Processes Tree
--------------
2132 - "C:\Users\<USER>\AppData\Local\Temp\Nim-Rev-Shell-Stageless.exe"
2176 - C:\Windows\explorer.exe
 2596 - %SAMPLEPATH%\Nim-Rev-Shell-Stageless.exe
2936 - %WINDIR%\explorer.exe
 3040 - C:\Windows\System32\svchost.exe

Modules loaded - Runtime Modules
--------------------------------
> BCRYPT.DLL
> BCRYPTPRIMITIVES.DLL
> KERNEL32.DLL
> WS2_32.DLL

Highlighted actions - Calls Highlighted
---------------------------------------
> BCryptGenRandom
> CloseHandle
> CreateFileA
> CreateProcessW
> CreateToolhelp32Snapshot
> DeleteProcThreadAttributeList
> GetCurrentProcess
> GetCurrentProcessId
> GetFileSize
> GetProcessHeap
> GetRngInterface
> GetSystemTimeAsFileTime
> HeapAlloc
> InitializeProcThreadAttributeList
> OpenProcess
> Process32FirstW
> Process32NextW
> ReadFile
> Sleep
<SNIP>

============================
Community report
============================

5 YARA Signatures Match - THOR APT Scanner
-------------------------------------------
RULE: HKTL_Nim_Implant_Indicators_Nov22_1
RULE_SET: Livehunt - Hacktools189 Indicators ðŸ› 
RULE_TYPE: VALHALLA rule feed only âš¡
RULE_LINK: https://valhalla.nextron-systems.com/info/rule/HKTL_Nim_Implant_Indicators_Nov22_1
DESCRIPTION: Detects NimC2 implants
REFERENCE: https://github.com/d4rckh/grc2
RULE_AUTHOR: Florian Roth

RULE: SUSP_Nim_Implant_Characteristics_Jan23_1
RULE_SET: Livehunt - Suspicious299 Indicators ðŸ¹
RULE_TYPE: THOR APT Scanner's rule set only ðŸ”¨
RULE_LINK: https://valhalla.nextron-systems.com/info/rule/SUSP_Nim_Implant_Characteristics_Jan23_1
DESCRIPTION: Detects characteristics found in Nim based loaders
REFERENCE: https://github.com/chvancooten/NimPlant
RULE_AUTHOR: Florian Roth

RULE: SUSP_ShellCode_Loader_Indicators_Nov22_1
RULE_SET: Livehunt - Suspicious273 Indicators ðŸ¹
RULE_TYPE: THOR APT Scanner's rule set only ðŸ”¨
RULE_LINK: https://valhalla.nextron-systems.com/info/rule/SUSP_ShellCode_Loader_Indicators_Nov22_1
DESCRIPTION: Detects indicators found in shellcode loaders
RULE_AUTHOR: Florian Roth

RULE: HKTL_Nim_Loader_Jul21_1
RULE_SET: Livehunt - Hacktools140 Indicators ðŸ› 
RULE_TYPE: VALHALLA rule feed only âš¡
RULE_LINK: https://valhalla.nextron-systems.com/info/rule/HKTL_Nim_Loader_Jul21_1
DESCRIPTION: Detects Nim based ShellCode loaders
RULE_AUTHOR: Florian Roth

RULE: SUSP_Double_Base64Encoded_Kernel32_Functions
RULE_SET: Livehunt - Suspicious62 Indicators ðŸ¹
RULE_TYPE: THOR APT Scanner's rule set only ðŸ”¨
RULE_LINK: https://valhalla.nextron-systems.com/info/rule/SUSP_Double_Base64Encoded_Kernel32_Functions
DESCRIPTION: Detects suspicious double base64 encoded kernel32 functions like OpenProcess, WriteProcessMemory and CreateRemoteThread
RULE_AUTHOR: Florian Roth

===================================================================================================================================
MetaDefender Cloud malware analysis platform - Detailed results
===================================================================================================================================

MetaDefender - Multiscanning: it is an advanced threat detection and prevention technology that increases detection rates, decreases
outbreak detection times and provides resiliency to anti-malware vendor issues.

======================================
MetaDefdender Multiscan Results
======================================

> Report: https://metadefender.opswat.com/results/file/bzI0MDIxMkZ2cDVQMEhnT2VRZGUtcll1WE4_mdaas/regular/multiscan
> Threats detected: 3/11 ENGINES
> Threat name: Unknown Threat

AV engine      Last update  Result
---------------------------------------------------------------------
IKARUS        Feb 12, 2024  Trojan.Crypter		
Bitdefender   Feb 12, 2024  Generic.Trojan.Cryptim.Marte.A.28A1F941	
AhnLab        Feb 6, 2024   Trojan/Win.Generic		
ClamAV        Feb 12, 2024  No threat detected			  
<...>

